some modifications made after sweepy-sweep, better save
